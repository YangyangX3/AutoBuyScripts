
# 淘宝抢购自动化脚本

**快速上手，精准抢购！** 本脚本基于Selenium，助您在指定时间自动完成淘宝购物车商品的结算和下单。

**项目来源：** 本项目基于GitHub上的[veezean/AutoBuyScript](https://github.com/veezean/AutoBuyScripts)项目进行优化。

## 核心功能

- **定时抢购**：精准设定时间，自动执行。
- **服务器时间同步**：通过API获取精确时间，消除本地时间误差。
- **提前准备**：在抢购时间前完成结算和按钮定位，提高成功率。
- **智能点击**：多种点击方法轮流尝试，解决元素点击被拦截问题。
- **快速刷新重试**：提交失败直接刷新页面重试，无需返回购物车。
- **按钮缓存**：记住有效的提交按钮选择器，加速后续提交。
- **自动登录**：支持手机淘宝扫码登录。
- **状态保持**：定时刷新，防止登录超时。
- **成功提醒**：订单成功后声音提示。

## 使用方法

1. **准备商品**：将目标商品加入购物车，并确保购物车中仅有所需抢购的商品。
2. **配置参数**：打开 `fastbuy_taobao.py`，根据需要修改以下关键参数：
   ```python
   # 是否检查并点击同意协议复选框
   CHECK_AGREEMENT_CHECKBOX = False
   # 最大重试次数
   MAX_RETRY_TIMES = 100
   # 抢购超时时间(分钟)
   PURCHASE_TIMEOUT_MINUTES = 5
   # 是否在提交订单成功后播放声音提醒
   PLAY_SOUND_ON_SUCCESS = True
   # 提前准备时间(分钟)
   PREPARE_MINUTES_BEFORE = 2
   ```
3. **运行脚本**：
   ```bash
   python fastbuy_taobao.py
   ```
4. **输入时间**：按提示格式（如 `2025-05-10 15:30:00`）输入抢购时间。
5. **扫码登录**：脚本自动打开浏览器，使用手机淘宝App扫描二维码登录。
6. **等待抢购**：登录后脚本将自动同步服务器时间，提前准备结算流程，并在设定时间精准提交订单。
7. **手动付款**：脚本仅负责提交订单，请在24小时内手动完成付款。

## 新增功能说明

1. **服务器时间校准**：使用苏宁易购API获取精确的服务器时间，消除本地时间误差。
2. **提前准备流程**：在抢购时间前2分钟自动进入购物车，完成结算并定位提交订单按钮。
3. **多种点击方法**：轮流尝试普通点击、JavaScript点击、Actions链点击等方法，解决元素点击被拦截问题。
4. **订单页面刷新重试**：提交失败后直接刷新当前页面重试，避免重新结算的时间开销。
5. **按钮选择器缓存**：记住有效的提交按钮选择器，加速后续提交操作。

## 环境要求

- **系统**：Windows / Mac / Linux
- **Python**：3.6+
- **浏览器**：Chrome (建议最新版)
- **ChromeDriver**：与Chrome版本匹配
- **Python依赖**：
  ```
  selenium==4.10.0+
  requests
  ```

## 安装步骤

1. **安装Python**：访问 [Python官网](https://www.python.org/downloads/) 下载并安装。
2. **安装依赖**：
   ```bash
   pip install selenium requests
   ```
3. **安装Chrome**：访问 [Chrome官网](https://www.google.com/chrome/) 下载并安装。
4. **下载ChromeDriver**：访问 [ChromeDriver下载页面](https://sites.google.com/a/chromium.org/chromedriver/downloads) 下载与Chrome版本匹配的驱动，并将其置于系统PATH或脚本同目录下。

## 注意事项

1. **购物车**：仅保留需抢购商品。
2. **抢购时间**：建议设置为实际开售时间，脚本会自动调整校准。
3. **网络**：保持网络稳定，推荐有线连接。
4. **浏览器**：脚本运行时勿手动操作，确保Chrome未阻止第三方软件注入。
5. **账号安全**：谨慎使用，避免频繁操作导致账号风险。
6. **法律责任**：本脚本仅供学习研究，用户需自行承担使用后果。

## 常见问题

1. **点击结算按钮失败**：脚本会自动尝试多种点击方法，如仍失败可查看生成的错误截图分析原因。
2. **服务器时间同步失败**：会自动降级使用本地时间，可检查网络连接。
3. **提交订单失败**：检查是否需勾选协议（`CHECK_AGREEMENT_CHECKBOX`参数），分析日志和截图。
4. **无法定位元素**：淘宝页面可能更新，查看错误日志中的XPath信息进行调整。

## 免责声明

本脚本仅供学习和研究使用，请勿用于任何商业或非法用途。使用本脚本可能违反淘宝平台的用户协议，用户需自行承担因使用本脚本而产生的一切法律责任。作者不对因使用本脚本导致的任何直接或间接损失负责。
